{% extends "base.html" %}

{% block title %}Settings - {{ title }}{% endblock %}

{% block nav_settings %}active{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-6">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">Settings</h1>
            <p class="mt-2 text-gray-600 dark:text-gray-400">
                Configure your AI Assistant preferences and system settings
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Settings Navigation -->
            <div class="lg:col-span-1">
                <nav class="space-y-1 sticky top-24">
                    <button class="settings-nav-item active" data-section="model">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364-.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                        Model Settings
                    </button>
                    
                    <button class="settings-nav-item" data-section="agents">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                        Agents
                    </button>
                    
                    <button class="settings-nav-item" data-section="memory">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/>
                        </svg>
                        Memory & Data
                    </button>
                    
                    <button class="settings-nav-item" data-section="interface">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"/>
                        </svg>
                        Interface
                    </button>
                    
                    <button class="settings-nav-item" data-section="security">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                        </svg>
                        Security
                    </button>
                    
                    <button class="settings-nav-item" data-section="system">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        System
                    </button>
                </nav>
            </div>

            <!-- Settings Content -->
            <div class="lg:col-span-3">
                <!-- Model Settings -->
                <div id="model-section" class="settings-section active">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Model Configuration</h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                                Configure AI model settings and parameters
                            </p>
                        </div>
                        
                        <div class="card-body space-y-6">
                            <!-- Current Model Status -->
                            <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h3 class="font-medium text-gray-900 dark:text-gray-100">Current Model</h3>
                                        <p class="text-sm text-gray-600 dark:text-gray-400" id="current-model-name">
                                            {{ current_model or "No model loaded" }}
                                        </p>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <div id="model-status-indicator" class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                        <span class="text-sm text-gray-600 dark:text-gray-400" id="model-device">
                                            {{ device or "Unknown" }}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="mt-4 grid grid-cols-3 gap-4 text-sm">
                                    <div>
                                        <span class="text-gray-500 dark:text-gray-400">Memory Usage:</span>
                                        <div id="memory-usage" class="font-medium">-- GB</div>
                                    </div>
                                    <div>
                                        <span class="text-gray-500 dark:text-gray-400">Context Length:</span>
                                        <div id="context-length" class="font-medium">4096 tokens</div>
                                    </div>
                                    <div>
                                        <span class="text-gray-500 dark:text-gray-400">Load Time:</span>
                                        <div id="load-time" class="font-medium">--</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Model Selection -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Available Models</h3>
                                <div id="available-models" class="space-y-3">
                                    <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                                        <svg class="w-8 h-8 mx-auto mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                        </svg>
                                        Loading available models...
                                    </div>
                                </div>
                            </div>

                            <!-- Generation Parameters -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Default Generation Parameters</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Temperature: <span id="default-temperature-value" class="text-ai-blue">0.7</span>
                                        </label>
                                        <input type="range" id="default-temperature" min="0.1" max="2.0" step="0.1" value="0.7" 
                                               class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                                            <span>Focused</span>
                                            <span>Creative</span>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Max Tokens: <span id="default-max-tokens-value" class="text-ai-blue">512</span>
                                        </label>
                                        <input type="range" id="default-max-tokens" min="50" max="4096" step="50" value="512"
                                               class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                        <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1">
                                            <span>Short</span>
                                            <span>Long</span>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Top P: <span id="default-top-p-value" class="text-ai-blue">0.9</span>
                                        </label>
                                        <input type="range" id="default-top-p" min="0.1" max="1.0" step="0.05" value="0.9"
                                               class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Repetition Penalty: <span id="default-rep-penalty-value" class="text-ai-blue">1.1</span>
                                        </label>
                                        <input type="range" id="default-rep-penalty" min="1.0" max="1.5" step="0.05" value="1.1"
                                               class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-lg appearance-none cursor-pointer">
                                    </div>
                                </div>
                            </div>

                            <!-- Model Actions -->
                            <div class="flex space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700">
                                <button id="load-model-btn" class="btn-primary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4-4m0 0l-4 4m0 0v12"/>
                                    </svg>
                                    Load Model
                                </button>
                                <button id="unload-model-btn" class="btn-secondary">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                    </svg>
                                    Unload Model
                                </button>
                                <button id="refresh-models-btn" class="btn-ghost">
                                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                    </svg>
                                    Refresh
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Agents Settings -->
                <div id="agents-section" class="settings-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Agent Configuration</h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                                Configure specialized AI agents and their behaviors
                            </p>
                        </div>
                        
                        <div class="card-body space-y-6">
                            <!-- Agent Status Overview -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                                    <div class="flex items-center">
                                        <div class="p-2 bg-blue-100 dark:bg-blue-900 rounded-lg">
                                            <svg class="w-5 h-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.955 8.955 0 01-2.172-.268c-.77-.268-1.645-.268-2.208.268L5.172 22H3a2 2 0 01-2-2V12C1 7.582 4.582 4 9 4h12c4.418 0 8 3.582 8 8z"/>
                                            </svg>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm font-medium text-gray-900 dark:text-gray-100">Chat Agent</p>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">General conversation</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                                    <div class="flex items-center">
                                        <div class="p-2 bg-green-100 dark:bg-green-900 rounded-lg">
                                            <svg class="w-5 h-5 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
                                            </svg>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm font-medium text-gray-900 dark:text-gray-100">Code Agent</p>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Programming assistance</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                                    <div class="flex items-center">
                                        <div class="p-2 bg-purple-100 dark:bg-purple-900 rounded-lg">
                                            <svg class="w-5 h-5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364-.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                            </svg>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm font-medium text-gray-900 dark:text-gray-100">CoDriver</p>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Agent coordinator</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Agent Specific Settings -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Agent-Specific Parameters</h3>
                                
                                <div class="space-y-4">
                                    <!-- Chat Agent Settings -->
                                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="text-md font-medium text-gray-900 dark:text-gray-100">Chat Agent</h4>
                                            <label class="flex items-center">
                                                <input type="checkbox" id="chat-agent-enabled" checked class="mr-2">
                                                <span class="text-sm text-gray-600 dark:text-gray-400">Enabled</span>
                                            </label>
                                        </div>
                                        
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                    Temperature: <span id="chat-temp-value">0.8</span>
                                                </label>
                                                <input type="range" id="chat-temperature" min="0.1" max="1.5" step="0.1" value="0.8" class="w-full">
                                            </div>
                                            <div>
                                                <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                    Max Tokens: <span id="chat-tokens-value">512</span>
                                                </label>
                                                <input type="range" id="chat-max-tokens" min="100" max="1024" step="50" value="512" class="w-full">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Code Agent Settings -->
                                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="text-md font-medium text-gray-900 dark:text-gray-100">Code Agent</h4>
                                            <label class="flex items-center">
                                                <input type="checkbox" id="code-agent-enabled" checked class="mr-2">
                                                <span class="text-sm text-gray-600 dark:text-gray-400">Enabled</span>
                                            </label>
                                        </div>
                                        
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                    Temperature: <span id="code-temp-value">0.3</span>
                                                </label>
                                                <input type="range" id="code-temperature" min="0.1" max="1.0" step="0.1" value="0.3" class="w-full">
                                            </div>
                                            <div>
                                                <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                    Max Tokens: <span id="code-tokens-value">1024</span>
                                                </label>
                                                <input type="range" id="code-max-tokens" min="256" max="2048" step="128" value="1024" class="w-full">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Agent Routing -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Agent Routing</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="auto-routing" checked class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Automatic Agent Routing</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Let CoDriver automatically choose the best agent for each message</p>
                                        </div>
                                    </label>
                                    
                                    <div class="ml-6 space-y-2">
                                        <div>
                                            <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                Confidence Threshold: <span id="confidence-threshold-value">0.7</span>
                                            </label>
                                            <input type="range" id="confidence-threshold" min="0.5" max="0.9" step="0.05" value="0.7" class="w-full">
                                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Higher values require more confidence before routing to specialized agents</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Memory Settings -->
                <div id="memory-section" class="settings-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Memory & Data Management</h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                                Configure conversation memory, embeddings, and data storage
                            </p>
                        </div>
                        
                        <div class="card-body space-y-6">
                            <!-- Memory Statistics -->
                            <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                                <h3 class="font-medium text-gray-900 dark:text-gray-100 mb-3">Memory Usage</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                                    <div>
                                        <div class="text-2xl font-bold text-ai-blue" id="total-conversations">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Conversations</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold text-ai-purple" id="total-messages">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Messages</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold text-green-600" id="embeddings-count">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Embeddings</div>
                                    </div>
                                    <div>
                                        <div class="text-2xl font-bold text-orange-600" id="storage-size">-- MB</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Storage Used</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Context Management -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Context Management</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm text-gray-600 dark:text-gray-400 mb-2">
                                            Max Context Length: <span id="max-context-value">4096</span> tokens
                                        </label>
                                        <input type="range" id="max-context-length" min="1024" max="8192" step="512" value="4096" class="w-full">
                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Longer context allows more conversation history but uses more memory</p>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <label class="flex items-center">
                                            <input type="checkbox" id="auto-summarize" checked class="mr-3">
                                            <div>
                                                <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Auto-summarize old conversations</span>
                                                <p class="text-xs text-gray-500 dark:text-gray-400">Compress old messages to save memory</p>
                                            </div>
                                        </label>
                                        
                                        <label class="flex items-center">
                                            <input type="checkbox" id="persistent-memory" checked class="mr-3">
                                            <div>
                                                <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Persistent memory across sessions</span>
                                                <p class="text-xs text-gray-500 dark:text-gray-400">Remember conversations between restarts</p>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Embeddings Settings -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Embeddings & Search</h3>
                                <div class="space-y-4">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="enable-embeddings" checked class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Enable semantic search</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Use embeddings for better context retrieval</p>
                                        </div>
                                    </label>
                                    
                                    <div class="ml-6 space-y-3">
                                        <div>
                                            <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                Similarity Threshold: <span id="similarity-threshold-value">0.7</span>
                                            </label>
                                            <input type="range" id="similarity-threshold" min="0.5" max="0.9" step="0.05" value="0.7" class="w-full">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                                Max Retrieved Chunks: <span id="max-chunks-value">5</span>
                                            </label>
                                            <input type="range" id="max-chunks" min="3" max="10" step="1" value="5" class="w-full">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Management Actions -->
                            <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Data Management</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    <button id="backup-data-btn" class="btn-secondary">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 12l3 3m0 0l3-3m-3 3V9"/>
                                        </svg>
                                        Backup Data
                                    </button>
                                    <button id="rebuild-embeddings-btn" class="btn-secondary">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                        </svg>
                                        Rebuild Embeddings
                                    </button>
                                    <button id="clear-data-btn" class="btn-danger">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                        </svg>
                                        Clear All Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Interface Settings -->
                <div id="interface-section" class="settings-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Interface Preferences</h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                                Customize the look and feel of your AI Assistant
                            </p>
                        </div>
                        
                        <div class="card-body space-y-6">
                            <!-- Theme Settings -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Appearance</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Theme</label>
                                        <div class="grid grid-cols-3 gap-3">
                                            <label class="theme-option">
                                                <input type="radio" name="theme" value="light" class="sr-only">
                                                <div class="theme-card">
                                                    <div class="theme-preview bg-white border-2 rounded-lg p-3">
                                                        <div class="w-full h-2 bg-gray-100 rounded mb-2"></div>
                                                        <div class="w-3/4 h-1 bg-gray-200 rounded mb-1"></div>
                                                        <div class="w-1/2 h-1 bg-gray-200 rounded"></div>
                                                    </div>
                                                    <span class="theme-label">Light</span>
                                                </div>
                                            </label>
                                            
                                            <label class="theme-option">
                                                <input type="radio" name="theme" value="dark" class="sr-only">
                                                <div class="theme-card">
                                                    <div class="theme-preview bg-gray-800 border-2 rounded-lg p-3">
                                                        <div class="w-full h-2 bg-gray-700 rounded mb-2"></div>
                                                        <div class="w-3/4 h-1 bg-gray-600 rounded mb-1"></div>
                                                        <div class="w-1/2 h-1 bg-gray-600 rounded"></div>
                                                    </div>
                                                    <span class="theme-label">Dark</span>
                                                </div>
                                            </label>
                                            
                                            <label class="theme-option">
                                                <input type="radio" name="theme" value="system" class="sr-only" checked>
                                                <div class="theme-card">
                                                    <div class="theme-preview bg-gradient-to-br from-white to-gray-800 border-2 rounded-lg p-3">
                                                        <div class="w-full h-2 bg-gray-400 rounded mb-2"></div>
                                                        <div class="w-3/4 h-1 bg-gray-500 rounded mb-1"></div>
                                                        <div class="w-1/2 h-1 bg-gray-500 rounded"></div>
                                                    </div>
                                                    <span class="theme-label">System</span>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Font Size: <span id="font-size-value">14px</span>
                                        </label>
                                        <input type="range" id="font-size" min="12" max="18" step="1" value="14" class="w-full">
                                    </div>
                                </div>
                            </div>

                            <!-- Layout Settings -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Layout</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="compact-mode" class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Compact mode</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Reduce spacing and padding for more content</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="sidebar-auto-hide" class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Auto-hide sidebars</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Automatically collapse sidebars when not in use</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="show-timestamps" checked class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Show timestamps</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Display message timestamps in chat</p>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Editor Settings -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Code Editor</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Editor Theme</label>
                                        <select id="editor-theme" class="input-primary">
                                            <option value="vs-dark">Dark</option>
                                            <option value="vs">Light</option>
                                            <option value="hc-black">High Contrast</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Editor Font Size: <span id="editor-font-size-value">14px</span>
                                        </label>
                                        <input type="range" id="editor-font-size" min="10" max="20" step="1" value="14" class="w-full">
                                    </div>
                                </div>
                                
                                <div class="mt-4 space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="editor-minimap" checked class="mr-3">
                                        <span class="text-sm text-gray-900 dark:text-gray-100">Show minimap</span>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="editor-line-numbers" checked class="mr-3">
                                        <span class="text-sm text-gray-900 dark:text-gray-100">Show line numbers</span>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="editor-word-wrap" class="mr-3">
                                        <span class="text-sm text-gray-900 dark:text-gray-100">Word wrap</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Notification Settings -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Notifications</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="toast-notifications" checked class="mr-3">
                                        <span class="text-sm text-gray-900 dark:text-gray-100">Show toast notifications</span>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="sound-notifications" class="mr-3">
                                        <span class="text-sm text-gray-900 dark:text-gray-100">Sound notifications</span>
                                    </label>
                                    
                                    <div class="ml-6">
                                        <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                            Notification Duration: <span id="notification-duration-value">5</span>s
                                        </label>
                                        <input type="range" id="notification-duration" min="3" max="10" step="1" value="5" class="w-full">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Settings -->
                <div id="security-section" class="settings-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">Security & Privacy</h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                                Configure security settings and data privacy options
                            </p>
                        </div>
                        
                        <div class="card-body space-y-6">
                            <!-- Data Privacy -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Data Privacy</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="local-only" checked class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Keep all data local</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">All conversations and data stay on this device</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="anonymize-data" class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Anonymize personal data</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Remove or encrypt personally identifiable information</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="auto-delete" class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Auto-delete old conversations</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Automatically remove conversations older than specified time</p>
                                        </div>
                                    </label>
                                    
                                    <div class="ml-6">
                                        <label class="block text-sm text-gray-600 dark:text-gray-400 mb-2">Delete after:</label>
                                        <select id="auto-delete-period" class="input-primary w-48" disabled>
                                            <option value="30">30 days</option>
                                            <option value="90" selected>90 days</option>
                                            <option value="180">180 days</option>
                                            <option value="365">1 year</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Access Control -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Access Control</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="require-auth" class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Require authentication</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Require login to access the assistant</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="session-timeout" checked class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Auto logout</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Automatically logout after inactivity</p>
                                        </div>
                                    </label>
                                    
                                    <div class="ml-6">
                                        <label class="block text-sm text-gray-600 dark:text-gray-400 mb-1">
                                            Session timeout: <span id="session-timeout-value">30</span> minutes
                                        </label>
                                        <input type="range" id="session-timeout-duration" min="15" max="120" step="15" value="30" class="w-full">
                                    </div>
                                </div>
                            </div>

                            <!-- File Access -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">File Access</h3>
                                <div class="space-y-3">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="restrict-file-access" checked class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Restrict file access to workspace</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Only allow access to files in the designated workspace directory</p>
                                        </div>
                                    </label>
                                    
                                    <label class="flex items-center">
                                        <input type="checkbox" id="scan-uploads" class="mr-3">
                                        <div>
                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-100">Scan uploaded files</span>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">Check uploaded files for security threats</p>
                                        </div>
                                    </label>
                                    
                                    <div>
                                        <label class="block text-sm text-gray-600 dark:text-gray-400 mb-2">Maximum file size:</label>
                                        <select id="max-file-size" class="input-primary w-48">
                                            <option value="1">1 MB</option>
                                            <option value="5" selected>5 MB</option>
                                            <option value="10">10 MB</option>
                                            <option value="50">50 MB</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Settings -->
                <div id="system-section" class="settings-section">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100">System Information</h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                                View system status and performance information
                            </p>
                        </div>
                        
                        <div class="card-body space-y-6">
                            <!-- System Health -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">System Health</h3>
                                <div id="system-health" class="space-y-3">
                                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                            <span class="text-sm font-medium">API Server</span>
                                        </div>
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Running</span>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 rounded-full bg-yellow-500" id="model-health-dot"></div>
                                            <span class="text-sm font-medium">AI Model</span>
                                        </div>
                                        <span class="text-sm text-gray-500 dark:text-gray-400" id="model-health-status">Loading...</span>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                            <span class="text-sm font-medium">Database</span>
                                        </div>
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Connected</span>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                            <span class="text-sm font-medium">Embeddings</span>
                                        </div>
                                        <span class="text-sm text-gray-500 dark:text-gray-400">Active</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Performance Metrics -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Performance</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <div class="text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="text-2xl font-bold text-blue-600" id="cpu-usage">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">CPU Usage</div>
                                    </div>
                                    
                                    <div class="text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="text-2xl font-bold text-green-600" id="memory-usage-percent">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Memory Usage</div>
                                    </div>
                                    
                                    <div class="text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="text-2xl font-bold text-purple-600" id="avg-response-time">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Avg Response</div>
                                    </div>
                                    
                                    <div class="text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="text-2xl font-bold text-orange-600" id="uptime">--</div>
                                        <div class="text-xs text-gray-500 dark:text-gray-400">Uptime</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Version Information -->
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">Version Information</h3>
                                <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-4">
                                    <dl class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                        <div>
                                            <dt class="font-medium text-gray-900 dark:text-gray-100">AI Assistant</dt>
                                            <dd class="text-gray-600 dark:text-gray-400">v1.0.0</dd>
                                        </div>
                                        <div>
                                            <dt class="font-medium text-gray-900 dark:text-gray-100">Python</dt>
                                            <dd class="text-gray-600 dark:text-gray-400" id="python-version">--</dd>
                                        </div>
                                        <div>
                                            <dt class="font-medium text-gray-900 dark:text-gray-100">FastAPI</dt>
                                            <dd class="text-gray-600 dark:text-gray-400" id="fastapi-version">--</dd>
                                        </div>
                                        <div>
                                            <dt class="font-medium text-gray-900 dark:text-gray-100">Last Updated</dt>
                                            <dd class="text-gray-600 dark:text-gray-400" id="last-updated">--</dd>
                                        </div>
                                    </dl>
                                </div>
                            </div>

                            <!-- System Actions -->
                            <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-gray-100 mb-4">System Actions</h3>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                    <button id="restart-system-btn" class="btn-secondary">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                                        </svg>
                                        Restart System
                                    </button>
                                    
                                    <button id="export-config-btn" class="btn-secondary">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                                        </svg>
                                        Export Config
                                    </button>
                                    
                                    <button id="check-updates-btn" class="btn-secondary">
                                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4-4m0 0l-4 4m0 0v12"/>
                                        </svg>
                                        Check Updates
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Confirmation Modals -->
<div id="confirm-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black bg-opacity-50" onclick="closeModal('confirm-modal')"></div>
    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white dark:bg-ai-dark rounded-lg shadow-xl p-6 w-96">
        <h3 class="text-lg font-medium mb-4" id="confirm-title">Confirm Action</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-6" id="confirm-message">Are you sure you want to proceed?</p>
        <div class="flex justify-end space-x-2">
            <button onclick="closeModal('confirm-modal')" class="btn-secondary">Cancel</button>
            <button id="confirm-action-btn" class="btn-primary">Confirm</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', path='js/settings.js') }}"></script>
{% endblock %}